## 协程是什么

协程其实是很古老的概念，1963年就被提出。协程是一种协作式的程序执行流，只有当协程主动让出控制权才会切换，并且可以在适当的时间点协作式的被切换回来。
协作式的程序执行流，指的是在一个线程中，协程可以主动挂起，转而执行另一个协程，而无需像使用多线程一样需要操作系统调度，进行线程上下文的切换。

## 多线程有什么问题？

**多线程真正的开销来源于线程阻塞唤醒调度。**

减少线程上下文切换的次数，其实就是减少线程阻塞唤醒的调度次数。

但是协程的挂起与恢复仍然是需要保存协程调用栈的，但是因为协程本身是应用层面实现的，一个协程默认只会占用几k、几十k的内存，相比线程是很轻量级的，我们下面的讨论都是基于协程的挂起/恢复操作远比线程的调度轻量的共识。

## 协程的线程模型

当前Java的线程模型为1:1的模式，即一个Java线程对应一个操作系统线程。

协程是实现在操作系统线程上的一种用户级线程，是一种M:N的线程模型（M为协程数量，N为操作系统内核线程数量）。